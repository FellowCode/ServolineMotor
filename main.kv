#:set window_height 320
#:set window_width 400

<RootWidget>:
    com_input: com_input
    connect_button: connect_button
    motor_switch: motor_switch
    speed_input: speed_input
    speed_error_img: speed_error_img
    accel_time_input: accel_time_input
    accel_error_img: accel_error_img
    deccel_time_input: deccel_time_input
    deccel_error_img: deccel_error_img
    work_time_input: work_time_input
    work_error_img: work_error_img
    preset_button: preset_button
    add_preset_button: add_preset_button
    del_preset_button: del_preset_button
    apply_param_button: apply_param_button
    update_params_button: update_params_button
    canvas:
        Color:
            rgb: (0.8, 0.8, 0.8, 1)
        Rectangle:
            size: (window_width, window_height)
            pos: (0, 0)
    BaseLabel:
        pos: (10, window_height-30)
        text: 'COM'
    ParamInput:
        id: com_input
        width: 30
        pos: (60, window_height-30)
    BaseButton:
        id: connect_button
        text: 'Соединиться'
        size: (90, 25)
        font_size: 12
        pos: (100, window_height-33)
        padding: [5, 2]
    BaseLabel:
        text: 'Motor'
        pos: (window_width-150, window_height-30)
    Switch:
        id: motor_switch
        active: False
        size_hint: (None, None)
        pos: (300, window_height-70)
    ParamLabel:
        text: 'Скорость (об/мин)'
        pos: (10, window_height-80)
    ParamInput:
        id: speed_input
        pos: (190, window_height-80)
    Image:
        id: speed_error_img
        source: 'error2.png'
        size_hint: None, None
        size: 20, 20
        pos: 228, window_height - 80
        color: (1, 1, 1, 1)
    ParamLabel:
        text: 'Время ускорения (мс)'
        pos: (10, window_height - 110)
    ParamInput:
        id: accel_time_input
        pos: (190, window_height - 110)
    Image:
        id: accel_error_img
        source: 'error2.png'
        size_hint: None, None
        size: 20, 20
        pos: 228, window_height - 110
        color: (1, 1, 1, 1)
    ParamLabel:
        text: 'Время торможения (мс)'
        pos: (10, window_height - 140)
    ParamInput:
        id: deccel_time_input
        pos: (190, window_height - 140)
    Image:
        id: deccel_error_img
        source: 'error2.png'
        size_hint: None, None
        size: 20, 20
        pos: 228, window_height - 140
        color: (1, 1, 1, 1)
    ParamLabel:
        text: 'Время работы (мс)'
        pos: (10, window_height - 170)
    ParamInput:
        id: work_time_input
        pos: (190, window_height - 170)
    Image:
        id: work_error_img
        source: 'error2.png'
        size_hint: None, None
        size: 20, 20
        pos: 228, window_height - 170
        color: (1, 1, 1, 0)
    Image:
        source: 'logo.jpg'
        size_hint: (None, None)
        size: (150, 150)
        pos: (window_width-155, window_height-195)
    BaseButton:
        id: preset_button
        text: 'Пресет'
        size: (130, 25)
        pos: (40, window_height - 205)
    BaseButton:
        id: add_preset_button
        size: (25, 25)
        pos: (175, window_height - 205)
        ButtonImage:
            source: 'add.png'
    BaseButton:
        id: del_preset_button
        size: (25, 25)
        pos: (205, window_height - 205)
        ButtonImage:
            source: 'delete.png'
    BaseButton:
        id: apply_param_button
        text: 'Применить параметры'
        size_hint: (None, None)
        width: 290
        pos: (40, window_height - 240)

    BaseButton:
        id: update_params_button
        size_hint: (None, None)
        width: 30
        pos: (330, window_height - 240)
        ButtonImage:
            source: 'update.png'


<AutoMode>:
    start_button: start_button
    stop_button: stop_button
    mode_button: mode_button
    reverse_switch: reverse_switch
    size_hint: (1, None)
    height: window_height - 300
    pos: (0, window_height - 300)
    BaseButton:
        id: start_button
        pos: (40, window_height - 275)
        width: 90
        text: 'Старт'
    BaseButton:
        id: stop_button
        pos: (140, window_height - 275)
        width: 90
        text: 'Стоп'
    BaseButton:
        id: mode_button
        pos: (240, window_height - 275)
        width: 120
        text: 'Ручной режим'
    ParamLabel:
        pos: (-70, window_height - 305)
        text: 'Реверс'
    Switch:
        id: reverse_switch
        size_hint: (None, None)
        size: (80, 40)
        pos: (110, window_height - 315)
        on_active: self.change_reverse


<ManualMode>:
    left_button: left_button
    right_button: right_button
    mode_button: mode_button
    size_hint: (1, None)
    height: window_height - 255
    pos: (0, window_height - 255)
    BaseButton:
        id: left_button
        pos: (40, window_height - 275)
        width: 90
        text: '<--'
    BaseButton:
        id: right_button
        pos: (140, window_height - 275)
        width: 90
        text: '-->'
    BaseButton:
        id: mode_button
        pos: (240, window_height - 275)
        width: 120
        text: 'Авто режим'

<ParamInput>:
    size_hint: (None, None)
    width: 40
    height: 20
    font_size: '12sp'
    multiline: False
    padding: [6, 2]

<BaseLabel@Label>:
    size_hint: (None, None)
    width: 40
    height: 20
    font_size: '14sp'
    color: (0.2, 0.2, 0.2, 1)

<ParamLabel@BaseLabel>:
    text_size: (200, 20)
    width: 120
    halign: 'right'

<BaseButton@Button>:
    size_hint: (None, None)
    color: (0.9, 0.9, 0.9, 1)
    height: 30

<ButtonImage@Image>:
    y: self.parent.y + self.parent.size[1]*.1
    x: self.parent.x + self.parent.size[0]*.1
    size: (self.parent.size[0]*.8, self.parent.size[1]*.8)
    allow_stretch: True
    color: (.8,.8,.8,1)

<AddPresetPopup@Popup>:
    size_hint: None, None
    size: 300, 130
    title: 'Добавить пресет'
    preset_input: preset_input
    ok_button: ok_button
    cancel_button: cancel_button
    BoxLayout:
        orientation: 'vertical'
        spacing: 5
        AnchorLayout:
            anchor_x: 'center'
            anchor_y: 'center'
            TextInput:
                id: preset_input
                size_hint: 0.7, 0.9
        BoxLayout:
            Button:
                id: ok_button
                text: 'Добавить'
            Button:
                id: cancel_button
                text: 'Отмена'

<QuestionPopup@Popup>:
    size_hint: None, None
    size: 340, 130
    title: 'Подтвердите'
    question: question
    ok_button: ok_button
    cancel_button: cancel_button
    BoxLayout:
        orientation: 'vertical'
        spacing: 5
        AnchorLayout:
            anchor_x: 'center'
            anchor_y: 'center'
            Label:
                id: question
                text: 'Какой-то вопрос'
        BoxLayout:
            Button:
                id: ok_button
                text: 'Ok'
            Button:
                id: cancel_button
                text: 'Отмена'

<ErrorPopup@Popup>:
    size_hint: None, None
    size: 300, 200
    title: 'Ошибка'
    BoxLayout:
        orientation: vertical
        spacing: 5
        AnchorLayout:
            anchor_x: 'center'
            anchor_y: 'center'
            size_hint_y: 0.8
            Label:
                id: error
                text: 'Какой-то текст'
        AnchorLayout:
            anchor_x: 'center'
            anchor_y: 'center'
            Button:
                id: ok_button
                text: 'Ok'


